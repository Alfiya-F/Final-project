```sql
-- 1.1. Проверка дубликатов по ключевым полям (город, год):
SELECT settlement, year, COUNT(*) as duplicate_count
FROM public."data"
GROUP BY settlement, year
HAVING COUNT(*) > 1;

-- 1.2. Проверка пропущенных значений:
SELECT 
  COUNT(*) FILTER (WHERE settlement IS NULL) as null_settlement,
  COUNT(*) FILTER (WHERE year IS NULL) as null_year,
  COUNT(*) FILTER (WHERE population IS NULL OR population = 0) as null_population,
  COUNT(*) FILTER (WHERE birth IS NULL) as null_birth,
  COUNT(*) FILTER (WHERE death IS NULL) as null_death
FROM public."data";

-- 1.3. Проверка некорректных отрицательных значений:
SELECT settlement, year, birth, death, population, doctors, hospital_beds
FROM public."data"
WHERE birth < 0 OR death < 0 OR population < 0 OR doctors < 0 OR hospital_beds < 0;

-- 1.4. Проверка выбросов в рождаемости и смертности:
SELECT settlement, year, birth, death 
FROM public."data"
WHERE birth > 50 OR death > 30;
